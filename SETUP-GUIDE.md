# 🎮 朝活ゲーム - セットアップガイド

## 🎯 新機能の概要

このシステムは朝活を**ゲーム化**して、継続的なモチベーションを維持します！

### 主な機能

#### 1. **参加時刻評価システム**
- 🌟 **オンタイム** (7:00-7:14): 10ポイント
- ⚠️ **遅刻** (7:15-7:59): 5ポイント
- 🔥 **大遅刻** (8:00-8:59): 2ポイント
- 💀 **危機感もてよ！brooo** (9:00以降): 0ポイント

#### 2. **ストリークシステム**
- 連続参加記録を自動計算
- オンタイム連続記録も別途記録
- 欠席申請を使えばストリークは継続

#### 3. **バッジ・称号システム**
- 🏆 **朝活マスター**: 30日連続オンタイム
- ⭐ **早起き王**: 7日連続オンタイム
- 🎯 **完璧主義者**: 遅刻ゼロ
- 🎉 **奇跡の参加**: 欠席申請したのに参加
- 💎 **ダイヤモンド**: 100日連続参加
- 🥇 **ゴールド**: 50日連続参加
- 🥈 **シルバー**: 30日連続参加
- 🥉 **ブロンズ**: 10日連続参加

#### 4. **レベルシステム**
- 100ポイントごとにレベルアップ
- ランキングに表示

#### 5. **欠席申請機能**
- Discordコマンド `/absence` で申請
- 当日の朝4時まで申請可能
- 申請すればストリークは継続

#### 6. **今日のMVP**
- その日最もポイントが高い人を表彰

---

## 📋 セットアップ手順

### 1. Google Sheetsの準備

前回のセットアップに加えて、**AbsenceLog**シートを追加：

1. Google Sheetsを開く
2. 下部の「+」ボタンで新しいシートを追加
3. シート名を「**AbsenceLog**」に変更

### 2. Sheetsの再初期化

新しいカラムを追加するため、再初期化が必要です：

```bash
npm run setup
```

成功すると、以下のメッセージが表示されます：
```
✅ ActivityLogシートの初期化が完了しました
✅ AbsenceLogシートの初期化が完了しました
```

### 3. Discord Client IDを取得

1. [Discord Developer Portal](https://discord.com/developers/applications)にアクセス
2. 作成したアプリケーションを開く
3. 「**General Information**」タブを開く
4. **APPLICATION ID**をコピー
5. `.env`ファイルに追加：

```env
CLIENT_ID=your_application_id_here
```

### 4. スラッシュコマンドを登録

```bash
npm run register-commands
```

成功すると：
```
✅ スラッシュコマンドの登録が完了しました！
📝 登録されたコマンド:
   /absence - 欠席申請（朝4時まで）
```

### 5. Botを起動

```bash
npm start
```

### 6. ダッシュボードを更新

1. Google Sheetsを開く
2. 「拡張機能」→「Apps Script」
3. 既存の`Code.gs`を削除
4. `gas/Code.gs`の内容をコピー&ペースト
5. 既存の`Dashboard.html`を削除
6. 新しく`Dashboard`HTMLファイルを追加
7. `gas/Dashboard.html`の内容をコピー&ペースト
8. 「デプロイ」→「デプロイを管理」
9. 既存のデプロイの編集アイコン（鉛筆マーク）をクリック
10. バージョンを「新バージョン」に変更
11. 「デプロイ」をクリック

---

## 🎮 使い方

### 通常の参加

ボイスチャンネルに参加するだけでOK！

- 7:14までに入れば🌟オンタイム（10pt）
- それ以降は時間に応じてポイントが減少

### 欠席申請

Discordで以下のコマンドを実行：

```
/absence
```

- 当日の朝4時までに申請
- ストリークは継続される
- でも参加したら「奇跡の参加🎉」バッジがもらえる！

### ダッシュボードで確認

デプロイしたURLにアクセスして：

- 今日のMVPを確認
- ランキングをチェック
- 自分のレベル・バッジを確認
- ストリークを維持

---

## 🏆 ゲーム戦略

### レベルを上げるには

1. **毎日7:14までに参加**（10pt/日）
2. **連続参加でストリークボーナス**
3. **欠席申請を活用してストリーク維持**

### バッジを集めるには

- **早起き王**: まず7日連続オンタイムを目指す
- **朝活マスター**: 30日連続オンタイムが必要
- **奇跡の参加**: たまには欠席申請しても参加してみる？

### ランキング1位になるには

- **継続が最重要**: 毎日10ptが積み重なる
- **オンタイム率を維持**: 遅刻すると効率が悪い
- **ストリークを絶対に切らない**: 欠席申請を使う

---

## 🔧 トラブルシューティング

### `/absence`コマンドが表示されない

```bash
npm run register-commands
```

を再実行してください。

### ダッシュボードにデータが表示されない

1. `ActivityLog`と`AbsenceLog`シートがあるか確認
2. `npm run setup`で初期化を再実行
3. Botを再起動

### ポイントが記録されない

1. Botのログを確認（エラーが表示されているはず）
2. Google Sheetsの権限を確認
3. `SPREADSHEET_ID`が正しいか確認

---

## 📊 データ構造

### ActivityLog

| カラム | 内容 |
|--------|------|
| 日付 | YYYY-MM-DD |
| ユーザーID | Discord User ID |
| ユーザー名 | Discord Username |
| 表示名 | Server Nickname |
| 参加時刻 | YYYY-MM-DD HH:mm:ss |
| 退出時刻 | YYYY-MM-DD HH:mm:ss |
| 滞在時間（分） | 数値 |
| 参加時（時間） | 0-23 |
| 状態 | on-time/late/very-late/critical |
| 絵文字 | 🌟⚠️🔥💀 |
| ラベル | オンタイム/遅刻/大遅刻/危機感もてよ！brooo |
| ポイント | 10/5/2/0 |
| 欠席申請済み | true/false |

### AbsenceLog

| カラム | 内容 |
|--------|------|
| 日付 | YYYY-MM-DD |
| ユーザーID | Discord User ID |
| ユーザー名 | Discord Username |
| 表示名 | Server Nickname |
| 申請時刻 | YYYY-MM-DD HH:mm:ss |

---

## 🎯 今後の拡張案

- [ ] Discord通知（レベルアップ時など）
- [ ] 週次/月次レポート
- [ ] 個人ページ（自分の統計詳細）
- [ ] チーム戦モード
- [ ] 季節イベント
- [ ] アチーブメントシステム

---

**朝活、ゲームのように楽しもう！** 🎮🌟
